(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[338],{2553:function(e,t,n){"use strict";n.r(t);var a=n(476),r=n(477),s=n(16),i=n(0),c=n(1515),l=n(483),o=n(482),d=n(548),u=n(1525),j=n(1526),b=n(550),p=n(551),m=n(480),h=n(470),O=n(528),x=n(474),g=n(487),f=n(21),_=n(1581),v=n(1653),y=n(500),k=n(479),w=n(1520),E=n(472),N=n(490),R=n.n(N),S=n(481),C=n.n(S),T=n(6),D=C()(R.a),W=function(e){var t=e.pointRuleList,n=(e.rule_type,e.TableDataLoading),a=e.setrefresh,r=e.refresh,s=e.setruleeditdata,c=[{name:"Rule Name",minWidth:"150px",sortable:!0,selector:"rule_name"},{name:"Business Name",minWidth:"150px",sortable:!0,selector:"businessname"},{name:"Is Range",minWidth:"70px",sortable:!0,selector:function(e){return e.is_range?Object(T.jsx)(w.a,{pill:!0,color:"success",className:"badge-center",children:"True"}):Object(T.jsx)(w.a,{pill:!0,color:"danger",className:"badge-center",children:"False"})}},{name:"Start Range",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.start_range})}))}},{name:"End Range",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.end_range||"--"})}))}},{name:"Reward Point",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.sender_reward_point||"--"})}))}},{name:"Start Date",minWidth:"150px",sortable:!0,selector:function(e){return e.start_date?e.start_date.split("T")[0]:"--"}},{name:"End Date",minWidth:"150px",sortable:!0,selector:function(e){return e.end_date?e.end_date.split("T")[0]:"--"}},{name:"Tier Name",minWidth:"150px",sortable:!0,selector:"tier_name"},{name:"Point Expiry Interval(days)",minWidth:"70px",sortable:!0,selector:"point_expiry_interval_days"},{name:"Active",minWidth:"80px",sortable:!0,selector:function(e){return e.is_active?Object(T.jsx)(w.a,{pill:!0,color:"success",className:"badge-center",children:"True"}):Object(T.jsx)(w.a,{pill:!0,color:"danger",className:"badge-center",children:"False"})}},{name:"Action",minWidth:"150px",selector:function(e){return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("span",{title:"Edit",children:Object(T.jsx)(_.a,{size:15,color:"#3b3acb",style:{cursor:"pointer"},onClick:function(t){s(e)}})})," \xa0\xa0",Object(T.jsx)("span",{title:"Delete",children:Object(T.jsx)(v.a,{size:15,color:"red",style:{cursor:"pointer"},onClick:function(t){return function(e,t){return e.preventDefault(),D.fire(Object(f.a)({title:"Do you want to Delete",text:"Information will be delete when another user will approve this operation.",icon:"warning",allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0,confirmButtonText:"Yes",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-danger ml-1"},showLoaderOnConfirm:!0,preConfirm:function(){return O.a.pmsPointRuleDelete({rule_id:t.id}).then((function(e){console.log(e),Object(E.c)({data:{message:e.data.message}}),a(r+1)})).catch((function(e){Object(E.a)(e),console.log(e.response)}))},buttonsStyling:!1},"allowOutsideClick",(function(){return!R.a.isLoading()}))).then((function(e){e.isConfirmed}))}(t,e)}})})]})}}];return Object(T.jsx)(i.Fragment,{children:Object(T.jsx)(y.a,{column:c,TableData:t,TableDataLoading:n})})},A=n(1583),P=n(638),B=function(e){var t=e.pointRuleList,n=(e.rule_type,e.TableDataLoading),a=e.setruleidforview,r=e.setref_id,s=[{name:"Rule Name",minWidth:"200px",sortable:!0,selector:"rule_name"},{name:"Business Name",minWidth:"150px",sortable:!0,selector:"businessname"},{name:"Is Range",minWidth:"70px",sortable:!0,selector:function(e){return e.is_range?Object(T.jsx)(w.a,{pill:!0,color:"success",className:"badge-center",children:"True"}):Object(T.jsx)(w.a,{pill:!0,color:"danger",className:"badge-center",children:"False"})}},{name:"Start Range",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.start_range})}))}},{name:"End Range",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.end_range||"--"})}))}},{name:"Reward Point",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.sender_reward_point||"--"})}))}},{name:"Start Date",minWidth:"150px",sortable:!0,selector:function(e){return e.start_date?e.start_date.split("T")[0]:"--"}},{name:"End Date",minWidth:"150px",sortable:!0,selector:function(e){return e.end_date?e.end_date.split("T")[0]:"--"}},{name:"Tier Name",minWidth:"150px",sortable:!0,selector:"tier_name"},{name:"Point Expiry Interval(days)",minWidth:"70px",sortable:!0,selector:"point_expiry_interval_days"},{name:"Active",minWidth:"80px",sortable:!0,selector:function(e){return e.is_active?Object(T.jsx)(w.a,{pill:!0,color:"success",className:"badge-center",children:"True"}):Object(T.jsx)(w.a,{pill:!0,color:"danger",className:"badge-center",children:"False"})}},{name:"Operation",minWidth:"70px",sortable:!0,selector:function(e){return Object(T.jsxs)(w.a,{color:Object(P.a)(e.action).color,pill:!0,className:"px-1",children:[" ",Object(P.a)(e.action).title," "]})}},{name:"Operation At",minWidth:"200px",sortable:!0,selector:function(e){return e.created_at?Object(k.b)(e.created_at):"N/A"}},{name:"Action",minWidth:"150px",selector:function(e){return Object(T.jsx)("span",{title:"View",children:Object(T.jsx)(A.a,{size:15,color:"teal",style:{cursor:"pointer"},onClick:function(t){return r((n=e).ref_id),void a(n.id);var n}})})}}];return Object(T.jsx)(i.Fragment,{children:Object(T.jsx)(y.a,{column:s,TableData:t,TableDataLoading:n})})},L=n(1550),I=n(1672),F=n(497),z=n(533),H=n(536),U=n(531),q=n(484),G=n(485),K=n(486),M=n(555),V=n(502),J=function(e){var t=e.modal,n=e.toggleModal,a=e.globalRuleInfo,r=e.setRefresh,c=e.refresh,d=e.action,u=Object(i.useState)([]),j=Object(s.a)(u,2),b=j[0],p=j[1],x=Object(i.useState)(!1),g=Object(s.a)(x,2),f=g[0],_=g[1];console.log(a),Object(i.useEffect)((function(){a.id&&O.a.getApprovalEntryforGlobal(a.id).then((function(e){console.log(e);var t,n=[],a=Object(F.a)(e.data.payload.module_data.roles);try{var r=function(){var a=t.value,r=e.data.payload.approved.find((function(e){return e.role_id===a.role_id}));r?n.push({role_id:a.role_name,approved_by:r.approved_by,approved_at:r.approved_at}):n.push({role_id:a.role_name,approved_by:"--",approved_at:""})};for(a.s();!(t=a.n()).done;)r()}catch(s){a.e(s)}finally{a.f()}p(n)})).catch((function(e){console.log(e),Object(E.a)(e)}))}),[a.id]);return Object(T.jsxs)(z.a,{size:"xl",isOpen:t,toggle:n,style:1===d?{border:"2px solid green"}:2===d?{border:"2px solid red"}:{},children:[Object(T.jsx)(H.a,{toggle:n,children:1===d?"Approve Global Role":2===d?"Reject Global Role":"Global Role Details"}),Object(T.jsxs)(U.a,{children:[Object(T.jsx)(q.a,{children:Object(T.jsxs)(G.a,{sm:"12",children:[Object(T.jsxs)(l.a,{children:[Object(T.jsx)(o.a,{children:Object(T.jsx)(m.a,{children:"Approval Entry"})}),Object(T.jsx)(K.a,{children:Object(T.jsx)(q.a,{children:Object(T.jsx)(G.a,{sm:"12",children:Object(T.jsxs)(M.a,{children:[Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"Role Name"}),Object(T.jsx)("th",{children:"Approved By"}),Object(T.jsx)("th",{children:"Approved At"})]}),0!==(null===b||void 0===b?void 0:b.length)?null===b||void 0===b?void 0:b.map((function(e,t){return Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:e.role_id}),Object(T.jsx)("td",{children:e.approved_by}),Object(T.jsx)("td",{children:e.approved_at?Object(k.b)(e.approved_at||""):"--"})]},t)})):Object(T.jsx)(V.a,{className:"text-center"})]})})})})]}),"`"]})}),Object(T.jsx)(q.a,{children:Object(T.jsx)(G.a,{sm:"12",className:"text-center",children:f?Object(T.jsxs)(h.a.Ripple,{color:"primary",className:"mr-1",disabled:!0,style:{marginTop:"25px"},children:[Object(T.jsx)(V.a,{color:"white",size:"sm"}),Object(T.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(T.jsx)(h.a.Ripple,{className:"ml-2",color:"primary",onClick:function(){_(!0),O.a.pmsGlobalAction({rule_id:a.id,action_type:d}).then((function(e){r(!c),Object(E.c)(e),_(!1),n(),console.log(e)})).catch((function(e){console.log(e.response),_(!1),n(),Object(E.a)(e)}))},type:"button",style:{marginTop:"25px"},children:Object(T.jsx)("span",{children:"Confirm"})})})})]})]})},Y=(C()(R.a),function(e){var t=e.setruleidforview,n=e.pointRuleList,a=(e.rule_type,e.TableDataLoading),r=e.refresh,c=e.setrefresh,l=e.setref_id,o=Object(i.useState)(0),d=Object(s.a)(o,2),u=d[0],j=d[1],b=Object(i.useState)({}),p=Object(s.a)(b,2),m=p[0],h=p[1],O=Object(i.useState)(!1),x=Object(s.a)(O,2),g=x[0],f=x[1],_=[{name:"Rule Name",minWidth:"150px",sortable:!0,selector:"rule_name"},{name:"Business Name",minWidth:"150px",sortable:!0,selector:"businessname"},{name:"Is Range",minWidth:"70px",sortable:!0,selector:function(e){return e.is_range?Object(T.jsx)(w.a,{pill:!0,color:"success",className:"badge-center",children:"True"}):Object(T.jsx)(w.a,{pill:!0,color:"danger",className:"badge-center",children:"False"})}},{name:"Start Range",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.start_range})}))}},{name:"End Range",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.end_range||"--"})}))}},{name:"Reward Point",minWidth:"50px",sortable:!0,selector:function(e){return e.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.sender_reward_point||"--"})}))}},{name:"Start Date",minWidth:"150px",sortable:!0,selector:function(e){return e.start_date?e.start_date.split("T")[0]:"--"}},{name:"End Date",minWidth:"150px",sortable:!0,selector:function(e){return e.end_date?e.end_date.split("T")[0]:"--"}},{name:"Tier Name",minWidth:"150px",sortable:!0,selector:"tier_name"},{name:"Point Expiry Interval(days)",minWidth:"70px",sortable:!0,selector:"point_expiry_interval_days"},{name:"Active",minWidth:"80px",sortable:!0,selector:function(e){return e.is_active?Object(T.jsx)(w.a,{pill:!0,color:"success",className:"badge-center",children:"True"}):Object(T.jsx)(w.a,{pill:!0,color:"danger",className:"badge-center",children:"False"})}},{name:"Operation",minWidth:"100px",sortable:!0,selector:function(e){return Object(T.jsxs)(w.a,{color:Object(P.a)(e.action).color,pill:!0,className:"px-1",children:[" ",Object(P.a)(e.action).title," "]})}},{name:"Operation By",minWidth:"100px",sortable:!0,selector:"created_by"},{name:"Operation At",minWidth:"200px",sortable:!0,selector:function(e){return e.created_at?Object(k.b)(e.created_at):"N/A"}},{name:"Action",minWidth:"150px",selector:function(e){return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("span",{title:"View",children:Object(T.jsx)(A.a,{size:15,color:"teal",style:{cursor:"pointer"},onClick:function(n){return l((a=e).ref_id),void t(a.id);var a}})})," \xa0\xa0",Object(T.jsx)("span",{title:"Approve",children:Object(T.jsx)(L.a,{size:15,color:"teal",style:{cursor:"pointer"},onClick:function(){h(e),f(!0),j(1)}})}),"\xa0\xa0",Object(T.jsx)("span",{title:"Reject",children:Object(T.jsx)(I.a,{size:15,color:"red",style:{cursor:"pointer"},onClick:function(){h(e),f(!0),j(2)}})})]})}}];return Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)(y.a,{column:_,TableData:n,TableDataLoading:a}),Object(T.jsx)(J,{modal:g,toggleModal:function(){return f(!g)},globalRuleInfo:m,refresh:r,setRefresh:c,action:u})]})}),Q=n(1),X=n(121),Z=n(1553),$=n(1514),ee=n(496),te=n(1488),ne=n(489),ae=n(1513),re=n(1485),se=(n(478),n(660)),ie=n(495),ce=n(633),le=[{value:1,label:"Active"},{value:0,label:"InActive"}],oe=function(e){var t=e.refresh,n=e.setrefresh,d=e.ruleeditdata,u=e.setruleeditdata,j=(Object(se.g)(),Object(i.useRef)(),Object(i.useState)([])),b=Object(s.a)(j,2),p=b[0],x=b[1],_=Object(i.useState)(""),v=Object(s.a)(_,2),y=(v[0],v[1]),k=Object(i.useState)({}),w=Object(s.a)(k,2),N=w[0],R=w[1],S=Object(i.useState)(!0),C=Object(s.a)(S,2),D=C[0],W=C[1],A=Object(i.useState)(!0),P=Object(s.a)(A,2),B=P[0],L=P[1],I=Object(i.useState)(!1),F=Object(s.a)(I,2),z=F[0],H=F[1],U=Object(i.useState)(!0),q=Object(s.a)(U,2),J=q[0],Y=q[1],oe=Object(i.useState)([]),de=Object(s.a)(oe,2),ue=(de[0],de[1],Object(i.useState)({value:null,label:"select..."})),je=Object(s.a)(ue,2),be=(je[0],je[1],Object(i.useState)(!1)),pe=Object(s.a)(be,2),me=(pe[0],pe[1],Object(i.useState)([{value:null,label:"All"}])),he=Object(s.a)(me,2),Oe=he[0],xe=he[1],ge=Object(i.useState)({}),fe=Object(s.a)(ge,2),_e=fe[0],ve=fe[1],ye=Object(i.useState)(le[0]),ke=Object(s.a)(ye,2),we=ke[0],Ee=ke[1],Ne=Object(i.useState)([{skustartrange:"",skuendrange:"",skupoints:""}]),Re=Object(s.a)(Ne,2),Se=Re[0],Ce=Re[1],Te=Object(i.useState)({status:1,skuamount:0,skupoints:0,skustartrange:0,skuendrange:0,product_id:null,isrange:!1,title:"",business_id:null,Tier:null,startdate:"",expiryDate:"",point_expiry_interval_days:365,productId:null,is_sku_rule:!0}),De=Object(s.a)(Te,2),We=De[0],Ae=De[1];Object(i.useEffect)(Object(r.a)(Object(a.a)().mark((function e(){var t,n,r,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([O.a.customerBusinessList().then((function(e){var t=e.data.payload,n=null,a=t.map((function(e){return+e.id===+d.bussiness_id&&(n={value:e.id,label:e.businessname}),{value:e.id,label:e.businessname}}));return console.log("defaultBussiness ",n),x(a),t.length?(R(n||a[0]),n?n.value:t[0].id):null})).catch((function(e){return console.log(e.response),Object(E.a)(e),null})),O.a.tierList().then((function(e){console.log(e);var t=e.data.payload,n=d.tire_id?+d.tire_id:null,a={value:null,label:"All"},r=t.map((function(e){return n&&+e.id===n&&(a={value:+e.id,label:e.tier}),{value:+e.id,label:e.tier}}));return xe([{value:null,label:"All"}].concat(Object(X.a)(r))),ve(a),null})).catch((function(e){return console.log(e.response),Object(E.a)(e),null}))]);case 2:t=e.sent,n=Object(s.a)(t,2),r=n[0],n[1],W(!1),Ae((function(e){return Object(Q.a)(Object(Q.a)(Object(Q.a)({},e),d),{},{title:d.rule_name,isrange:d.is_range,status:d.is_active?1:0,business_id:r,Tier:d.tire_id,startdate:d.start_date?d.start_date.split("T")[0]:"",expiryDate:d.end_date?d.end_date.split("T")[0]:"",productId:null,skuamount:d.is_range?0:d.map_item.length?d.map_item[0].start_range:0,skupoints:d.is_range?0:d.map_item.length?d.map_item[0].sender_reward_point:0})})),d.is_active||Ee({value:0,label:"InActive"}),d.is_range&&d.map_item.length&&(i=d.map_item.map((function(e){return{skustartrange:e.start_range,skuendrange:e.end_range,skupoints:e.sender_reward_point}})),Ce(i)),L(!1);case 11:case"end":return e.stop()}}),e)}))),[]);var Pe=function(e){Ae(Object(Q.a)(Object(Q.a)({},We),{},Object(f.a)({},e.target.name,e.target.value)))},Be=function(e,t){!function(){for(var e=!0,t=0;t<Se.length;t++)if(e=Object.values(Se[t]).includes(""))return;Y(e)}();var n=Object(X.a)(Se);n[t]=Object(Q.a)(Object(Q.a)({},n[t]),{},Object(f.a)({},e.target.name,parseFloat(e.target.value))),Ce(n)};console.log("RangeArray ",Se);return Object(T.jsx)(i.Fragment,{children:B?Object(T.jsxs)(i.Fragment,{children:[" ",Object(T.jsx)(ce.a,{active:!0})," ",Object(T.jsx)(ce.a,{active:!0})," ",Object(T.jsx)(ce.a,{active:!0})," "]}):Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)(h.a.Ripple,{className:"mb-1",color:"primary",onClick:function(e){u(null)},children:Object(T.jsxs)("div",{className:"d-flex align-items-center",children:[Object(T.jsx)(Z.a,{size:17,style:{marginRight:"5px"}}),Object(T.jsx)("span",{children:"Back"})]})}),Object(T.jsxs)(l.a,{children:[Object(T.jsx)(o.a,{className:"border-bottom",children:Object(T.jsx)(m.a,{tag:"h4",children:"Edit Rule"})}),Object(T.jsx)(K.a,{style:{paddingTop:"15px"},children:Object(T.jsxs)(ee.a,{className:"row",style:{width:"100%"},onSubmit:function(e){e.preventDefault();var a=We.title,r=We.Tier,s=We.business_id,i=We.status,c=We.startdate,l=We.expiryDate,o=We.point_expiry_interval_days,j=We.skuamount,b=We.skupoints,p=(We.productId,We.isrange),m=[],h={rule_id:d.id,rule_name:a,is_sku_rule:!1,is_global_rule:!0,is_service_rule:!1,bussiness_id:+s,is_range:p,is_active:1===i||!1,start_date:c,end_date:l,point_expiry_interval_days:+o,tire_id:r?+r:r,items:[]};h.is_range?Se.map((function(e){m.push({product_id:null,service_id:null,start_range:e.skustartrange,end_range:e.skuendrange,point_receiver_type:"sender",sender_reward_point:e.skupoints,receiver_reward_point:0})})):m.push({product_id:null,service_id:null,start_range:j,end_range:null,point_receiver_type:"sender",sender_reward_point:b,receiver_reward_point:0}),h.items=m,console.log("body ",h),H(!0),O.a.pmsPointRuleEdit(h).then((function(e){Object(E.c)({data:{message:e.data.payload.msg}}),n(t+1),u(null)})).catch((function(e){H(!1),Object(E.a)(e),console.log(e.response)}))},autoComplete:"off",children:[Object(T.jsx)(G.a,{md:"4",children:Object(T.jsxs)(te.a,{children:[Object(T.jsx)(ne.a,{for:"voucherValue",children:"Title"}),Object(T.jsx)(ae.a,{type:"text",name:"title",id:"title",value:We.title,onChange:Pe,required:!0,placeholder:"title"})]})}),Object(T.jsx)(G.a,{sm:"4",children:Object(T.jsxs)(te.a,{children:[Object(T.jsxs)(ne.a,{for:"Business",children:["Select a Business ",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsx)(ie.a,{theme:g.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:function(e){Ae((function(t){return Object(Q.a)(Object(Q.a)({},t),{},{business_id:e.value})})),y(e.value),R(e)},value:N,options:p,isLoading:D})]})}),Object(T.jsx)(G.a,{md:"4",children:Object(T.jsxs)(te.a,{children:[Object(T.jsx)(ne.a,{for:"Business",children:"Select a Tier"}),Object(T.jsx)(ie.a,{theme:g.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",defaultValue:_e,onChange:function(e){return Ae(Object(Q.a)(Object(Q.a)({},We),{},{Tier:e.value}))},options:Oe})]})}),Object(T.jsx)(G.a,{md:"3",children:Object(T.jsxs)(te.a,{children:[Object(T.jsxs)(ne.a,{for:"startdate",children:["Start Date",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsx)(ae.a,{type:"date",min:(new Date).toLocaleDateString("fr-CA"),name:"startdate",id:"startdate",value:We.startdate,onChange:Pe,required:!0,placeholder:"0"})]})}),Object(T.jsx)(G.a,{md:"3",children:Object(T.jsxs)(te.a,{children:[Object(T.jsxs)(ne.a,{for:"expiryDate",children:["Expiry Date",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsx)(ae.a,{type:"date",min:(new Date).toLocaleDateString("fr-CA"),name:"expiryDate",id:"expiryDate",value:We.expiryDate,onChange:Pe,required:!0,placeholder:"0"})]})}),Object(T.jsx)(G.a,{md:"3",children:Object(T.jsxs)(te.a,{children:[Object(T.jsx)(ne.a,{for:"Business",children:"Status"}),Object(T.jsx)(ie.a,{theme:g.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",defaultValue:we,onChange:function(e){Ae(Object(Q.a)(Object(Q.a)({},We),{},{status:e.value}))},options:le})]})}),Object(T.jsx)(G.a,{md:"3",children:Object(T.jsxs)(te.a,{children:[Object(T.jsx)(ne.a,{for:"point_expiry_interval_days",children:"Point Expiry Interval (Days)"}),Object(T.jsx)(ae.a,{type:"number",name:"point_expiry_interval_days",id:"point_expiry_interval_days",value:We.point_expiry_interval_days,onChange:Pe,min:0,placeholder:"0",onWheel:function(e){return e.target.blur()}})]})}),Object(T.jsx)(G.a,{sm:"12",className:"mb-1",children:Object(T.jsx)(te.a,{children:Object(T.jsx)(re.a,{type:"switch",id:"isrange",name:"isrange",label:"Is Range?",checked:We.isrange,onChange:function(e){e.target.checked?Ae(Object(Q.a)(Object(Q.a)({},We),{},{isrange:!0})):Ae(Object(Q.a)(Object(Q.a)({},We),{},{isrange:!1}))}})})}),We.isrange?null:Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)(G.a,{sm:"6",children:Object(T.jsxs)(te.a,{children:[Object(T.jsxs)(ne.a,{for:"skuamount",children:["SKU Amount",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsx)(ae.a,{type:"number",name:"skuamount",id:"skuamount",value:We.skuamount,onChange:Pe,required:!0,min:1,placeholder:"0",onWheel:function(e){return e.target.blur()}})]})}),Object(T.jsx)(G.a,{sm:"6",children:Object(T.jsxs)(te.a,{children:[Object(T.jsxs)(ne.a,{for:"skupoints",children:["SKU Points",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsx)(ae.a,{type:"number",name:"skupoints",id:"skupoints",value:We.skupoints,onChange:Pe,required:!0,min:0,placeholder:"0",step:1,onWheel:function(e){return e.target.blur()}})]})}),"  "]}),!!We.isrange&&Object(T.jsx)(G.a,{md:"12",children:Object(T.jsxs)(M.a,{bordered:!0,responsive:!0,children:[Object(T.jsx)("thead",{style:{background:"white"},children:Object(T.jsxs)("tr",{children:[Object(T.jsxs)("th",{style:{background:"white"},children:["SKU Start Range",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsxs)("th",{style:{background:"white"},children:["SKU End Range",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsxs)("th",{style:{background:"white"},children:["SKU Point",Object(T.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(T.jsx)("th",{style:{background:"white"},children:"Action"})]})}),Object(T.jsx)("tbody",{children:Se.map((function(e,t){return console.log("row ",e),Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:Object(T.jsx)(ae.a,{type:"number",name:"skustartrange",id:"skustartrange".concat(t),value:e.skustartrange,min:t>0?Number(Se[t-1].skuendrange)+.01:0,onChange:function(e){return Be(e,t)},required:!0,placeholder:"0",onWheel:function(e){return e.target.blur()},step:"any"})}),Object(T.jsx)("td",{children:Object(T.jsx)(ae.a,{type:"number",name:"skuendrange",id:"skuendrange".concat(t),value:e.skuendrange,min:e.skustartrange||0,step:"any",onChange:function(e){return Be(e,t)},required:!0,placeholder:"0",onWheel:function(e){return e.target.blur()}})}),Object(T.jsx)("td",{children:Object(T.jsx)(ae.a,{type:"number",name:"skupoints",id:"skupoints".concat(t),value:e.skupoints,min:0,step:1,onChange:function(e){return Be(e,t)},required:!0,placeholder:"0",onWheel:function(e){return e.target.blur()}})}),Object(T.jsxs)("td",{children:[Object(T.jsx)(h.a.Ripple,{size:"sm",color:"info",type:J?"submit":"button",onClick:function(e){for(var t=0;t<Se.length;t++){if(Object.values(Se[t]).includes(""))return}Ce([].concat(Object(X.a)(Se),[{skustartrange:Number(Se[Se.length-1].skuendrange)+.01,skuendrange:"",skupoints:""}])),Y(!0)},children:Object(T.jsx)(c.a,{size:15})}),"\xa0\xa0",Se.length>1&&Object(T.jsx)(h.a.Ripple,{size:"sm",color:"danger",onClick:function(e){Ce(Se.filter((function(e,n){return n!==t})))},children:Object(T.jsx)($.a,{size:15})})]})]},t)}))})]})}),Object(T.jsx)(G.a,{sm:"12",className:"text-center",children:z?Object(T.jsxs)(h.a.Ripple,{color:"primary",className:"mr-1",disabled:!0,style:{marginTop:"25px"},children:[Object(T.jsx)(V.a,{color:"white",size:"sm"}),Object(T.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(T.jsx)(h.a.Ripple,{className:"ml-2",color:"primary",type:"submit",style:{marginTop:"25px"},children:Object(T.jsx)("span",{children:"Submit"})})})]})})]})]})})},de=["Rule Name","Bussiness Name","Is Range","Data","Start Date","End Date","Tier Name","Point Expiry Interval(days)","Active"],ue=["rule_name","businessname","is_range","data","start_date","end_date","tier_name","point_expiry_interval_days","is_active"],je=function(e){var t=e.setruleidforview,n=e.ruleidforview,c=e.ref_id,d=Object(i.useState)(!0),u=Object(s.a)(d,2),j=u[0],b=u[1],p=Object(i.useState)({}),x=Object(s.a)(p,2),g=x[0],f=x[1],_=Object(i.useState)(""),v=Object(s.a)(_,2),y=v[0],k=v[1],w=Object(i.useState)({}),N=Object(s.a)(w,2),R=N[0],S=N[1];return Object(i.useEffect)(Object(r.a)(Object(a.a)().mark((function e(){var t,i,l,o,d;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,Promise.all([O.a.pmsPointRuleDetail({rule_id:c||-1}).then(function(){var e=Object(r.a)(Object(a.a)().mark((function e(t){var n,r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data.payload,console.log("main ",n),!n){e.next=7;break}return r=Object(Q.a)(Object(Q.a)({},n),{},{productname:"--",is_range:n.is_range?"True":"False",data:null,start_date:n.start_date?n.start_date.split("T")[0]:"--",end_date:n.end_date?n.end_date.split("T")[0]:"--",is_active:n.is_active?"True":"False"}),e.abrupt("return",r);case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e.response),Object(E.a)(e),{}})),O.a.pmsTempPointRuleDetail({rule_id:n}).then(function(){var e=Object(r.a)(Object(a.a)().mark((function e(t){var n,r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data.payload,console.log("temp payload ",n),r=Object(Q.a)(Object(Q.a)({},n),{},{productname:"--",is_range:n.is_range?"True":"False",data:null,start_date:n.start_date?n.start_date.split("T")[0]:"--",end_date:n.end_date?n.end_date.split("T")[0]:"--",is_active:n.is_active?"True":"False"}),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e.response),Object(E.a)(e),{}}))]);case 3:t=e.sent,i=Object(s.a)(t,2),l=i[0],"Insert"!==(o=i[1]).action&&(d=!0,console.log("details ",l),o.map_item.map((function(e,t){var n=l.map_item[t]?l.map_item[t].start_range:-1,a=l.map_item[t]?l.map_item[t].end_range:-1,r=l.map_item[t]?l.map_item[t].sender_reward_point:-1;console.log("item ",e),console.log("raw ",{start_range:n,end_range:a,sender_reward_point:r}),(e.start_range!==n||e.end_range!==a||e.sender_reward_point!==r)&&(d=!1)})),d||(o.data=" ")),S(l),k(o.action),f(o),b(!1);case 12:case"end":return e.stop()}}),e)}))),[]),Object(T.jsx)(i.Fragment,{children:j?Object(T.jsxs)(i.Fragment,{children:[" ",Object(T.jsx)(ce.a,{active:!0})," ",Object(T.jsx)(ce.a,{active:!0})," ",Object(T.jsx)(ce.a,{active:!0})," "]}):Object(T.jsxs)(i.Fragment,{children:[" ",Object(T.jsx)(h.a.Ripple,{className:"mb-1",color:"primary",onClick:function(e){t(null)},children:Object(T.jsxs)("div",{className:"d-flex align-items-center",children:[Object(T.jsx)(Z.a,{size:17,style:{marginRight:"5px"}}),Object(T.jsx)("span",{children:"Back"})]})}),Object(T.jsxs)(l.a,{children:[Object(T.jsx)(o.a,{className:"border-bottom",children:Object(T.jsx)(m.a,{tag:"h4",children:"Global Rule Temp Details"})}),Object(T.jsx)(K.a,{style:{paddingTop:"15px"},children:Object(T.jsxs)(M.a,{hover:!0,responsive:!0,children:[Object(T.jsx)("thead",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"Parameter"}),Object(T.jsx)("th",{children:"Old Data"}),Object(T.jsx)("th",{children:"New Data"})]})}),Object(T.jsx)("tbody",{children:de.map((function(e,t){return Object(T.jsxs)("tr",{style:{backgroundColor:R[ue[t]]!==g[ue[t]]&&"Insert"!==y?"#f9c9c9":null},children:[Object(T.jsx)("td",{style:{fontWeight:"bold"},children:e}),Object(T.jsx)("td",{children:"data"===ue[t]&&"Insert"!==y?Object(T.jsx)(i.Fragment,{children:Object(T.jsxs)(M.a,{responsive:!0,children:[Object(T.jsx)("thead",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"Start Range"}),Object(T.jsx)("th",{children:"End Range"}),Object(T.jsx)("th",{children:"Reward Point"})]})}),Object(T.jsx)("tbody",{children:Object(T.jsx)("tr",{children:Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)("td",{children:R.map_item.map((function(e,t){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.start_range},t+1)}))}),Object(T.jsx)("td",{children:R.map_item.map((function(e,t){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.end_range||"--"},t+1)}))}),Object(T.jsx)("td",{children:R.map_item.map((function(e,t){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.sender_reward_point||"--"},t+1)}))})]})})})]})}):R[ue[t]]}),Object(T.jsx)("td",{children:"data"===ue[t]?Object(T.jsx)(i.Fragment,{children:Object(T.jsxs)(M.a,{responsive:!0,children:[Object(T.jsx)("thead",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"Start Range"}),Object(T.jsx)("th",{children:"End Range"}),Object(T.jsx)("th",{children:"Reward Point"})]})}),Object(T.jsx)("tbody",{children:Object(T.jsx)("tr",{children:Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)("td",{children:g.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.start_range})}))}),Object(T.jsx)("td",{children:g.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.end_range||"--"})}))}),Object(T.jsx)("td",{children:g.map_item.map((function(e){return Object(T.jsx)("div",{style:{padding:"5px 0",borderBottom:"1px solid #E0E0E0",width:"100px"},children:e.sender_reward_point||"--"})}))})]})})})]})}):g[ue[t]]})]},t+1)}))})]})})]})]})})};t.default=function(){var e=Object(i.useState)([]),t=Object(s.a)(e,2),n=t[0],f=t[1],_=Object(i.useState)([]),v=Object(s.a)(_,2),y=v[0],k=v[1],w=Object(i.useState)([]),N=Object(s.a)(w,2),R=N[0],S=N[1],C=Object(i.useState)(!0),D=Object(s.a)(C,2),A=D[0],P=D[1],L=Object(i.useState)(null),I=Object(s.a)(L,2),F=I[0],z=I[1],H=Object(i.useState)(null),U=Object(s.a)(H,2),q=U[0],G=U[1],K=Object(i.useState)(null),M=Object(s.a)(K,2),V=M[0],J=M[1],Q=Object(i.useState)(1),X=Object(s.a)(Q,2),Z=X[0],$=X[1],ee=Object(i.useState)("1"),te=Object(s.a)(ee,2),ne=te[0],ae=te[1],re=function(e){return ae(e)};return Object(i.useEffect)(Object(r.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.pmsPointRuleList({rule_type:2}).then((function(e){console.log(e);var t=e.data.payload,n=t.list,a=t.mypending,r=t.approvepending;f(n),k(a),S(r),P(!1)})).catch((function(e){Object(E.a)(e),console.log(e),P(!1)}));case 2:case"end":return e.stop()}}),e)}))),[Z]),Object(T.jsx)(i.Fragment,{children:F?Object(T.jsx)(oe,{refresh:Z,setrefresh:$,ruleeditdata:F,setruleeditdata:z}):q?Object(T.jsx)(je,{setruleidforview:G,ruleidforview:q,ref_id:V}):Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)(l.a,{children:Object(T.jsx)(o.a,{children:Object(T.jsxs)(d.a,{tabs:!0,children:[Object(T.jsx)(u.a,{children:Object(T.jsx)(j.a,{active:"1"===ne,onClick:function(){return re("1")},children:Object(T.jsx)("span",{className:"align-middle d-none d-sm-block",children:"Rule List"})})}),g.j.includes(34)&&Object(T.jsx)(u.a,{children:Object(T.jsx)(j.a,{active:"2"===ne,onClick:function(){return re("2")},children:Object(T.jsx)("span",{className:"align-middle d-none d-sm-block",children:"My Pending"})})}),g.j.includes(34)&&Object(T.jsx)(u.a,{children:Object(T.jsx)(j.a,{active:"3"===ne,onClick:function(){return re("3")},children:Object(T.jsx)("span",{className:"align-middle d-none d-sm-block",children:"Approve"})})})]})})}),Object(T.jsx)(l.a,{children:Object(T.jsxs)(b.a,{activeTab:ne,children:[Object(T.jsx)(p.a,{tabId:"1",children:Object(T.jsxs)(l.a,{children:[Object(T.jsxs)(o.a,{className:"border-bottom",children:[Object(T.jsx)(m.a,{tag:"h4",children:"Global Rules"}),Object(T.jsx)("div",{children:g.j.includes(16)&&Object(T.jsx)(h.a.Ripple,{className:"ml-2",color:"primary",tag:x.b,to:"/createOverallPointRuleForAdmin",children:Object(T.jsxs)("div",{className:"d-flex align-items-center",children:[Object(T.jsx)(c.a,{size:17,style:{marginRight:"5px"}}),Object(T.jsx)("span",{children:"Create Global Rule"})]})})})]}),Object(T.jsx)(W,{pointRuleList:n,rule_type:1,TableDataLoading:A,refresh:Z,setrefresh:$,setruleeditdata:z})]})}),Object(T.jsx)(p.a,{tabId:"2",children:Object(T.jsx)(B,{pointRuleList:y,rule_type:1,TableDataLoading:A,setruleidforview:G,setref_id:J})}),Object(T.jsx)(p.a,{tabId:"3",children:Object(T.jsx)(Y,{pointRuleList:R,rule_type:1,TableDataLoading:A,refresh:Z,setrefresh:$,setruleidforview:G,setref_id:J})})]})})]})})}},472:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i}));n(0);var a=n(127),r=function(e){try{var t=e.response;404===t.status||401===t.status||400===t.status||500===t.status||409===t.status?a.f.error(t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):a.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){a.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},s=function(e){try{var t=e.response;404!==t.status&&401!==t.status&&400!==t.status||a.f.error(t.data.errors?t.data.errors[Object.keys(t.data.errors)[0]]:t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){a.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},i=function(e){var t=e.data.message||"success";a.f.success(t,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},479:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return o}));var a=n(476),r=n(477),s={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},i=function(e){return new Date(e).toLocaleDateString(void 0,s)},c=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},l=function(){var e=Object(r.a)(Object(a.a)().mark((function e(t){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t){e.next=4;break}return window.location.href="/Adminlogin",e.next=4,localStorage.clear();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(e,t,n){var a=document.createElement("a"),r=function(e){var n;return n="",n+=t.join(","),n+="\n",e.forEach((function(e){var a=0;t.forEach((function(t){a>0&&(n+=","),n+=e[t],a++})),n+="\n"})),n}(e);if(null!==r){var s=JSON.parse(localStorage.getItem("userData")),i="".concat(n,"_").concat((new Date).toISOString(),"_").concat(s.fullname.replaceAll(/\s/g,""),".csv");r.match(/^data:text\/csv/i)||(r="data:text/csv;charset=utf-8,".concat(r)),a.setAttribute("href",encodeURI(r)),a.setAttribute("download",i),a.click()}}},500:function(e,t,n){"use strict";var a=n(16),r=n(0),s=n(1552),i=n(502),c=n(499),l=n.n(c),o=n(501),d=n.n(o),u=n(6);t.a=function(e){var t=e.column,n=e.TableData,c=e.TableDataLoading,o=Object(r.useState)(0),j=Object(a.a)(o,2),b=j[0],p=j[1];return Object(u.jsx)(r.Fragment,{children:Object(u.jsx)(d.a,{noHeader:!0,pagination:!0,columns:t,paginationPerPage:10,className:"react-dataTable",sortIcon:Object(u.jsx)(s.a,{size:10}),paginationDefaultPage:b+1,paginationComponent:function(){return Object(u.jsx)(l.a,{previousLabel:"",nextLabel:"",forcePage:b,onPageChange:function(e){return function(e){p(e.selected)}(e)},pageCount:n.length?n.length/10:1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",breakLinkClassName:"page-link",nextLinkClassName:"page-link",nextClassName:"page-item next",previousClassName:"page-item prev",previousLinkClassName:"page-link",pageLinkClassName:"page-link",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pr-1 mt-1"})},data:n,progressPending:c,progressComponent:Object(u.jsx)(i.a,{color:"primary"}),responsive:!0,pointerOnHover:!0,highlightOnHover:!0,striped:!0})})}},638:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var a={1:{title:"Active",color:"light-success "},0:{title:"Pending",color:"light-primary"},5:{title:"Stopped",color:"light-danger"},11:{title:"Unpaid",color:"light-primary"}},r={1:{title:"Active",color:"light-success "},0:{title:"In-Active",color:"light-primary"}},s={Insert:{title:"Insert",color:"light-success "},Update:{title:"Update",color:"light-primary"},Delete:{title:"Delete",color:"light-danger"},INSERT:{title:"INSERT",color:"light-success "},UPDATE:{title:"UPDATE",color:"light-primary"},DELETE:{title:"DELETE",color:"light-danger"}},i=function(e){return a[e]||{title:"N/A",color:"light-danger"}},c=function(e){return r[e]||{title:"N/A",color:"light-danger"}},l=function(e){return s[e]||{title:"N/A",color:"light-danger"}}}}]);
//# sourceMappingURL=338.15949067.chunk.js.map