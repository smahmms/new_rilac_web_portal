{"version":3,"sources":["views/extensions/import-export/Export.js","@core/components/extensions-header/index.js"],"names":["initialData","id","name","username","email","website","Export","tableRef","useRef","_useState","useState","data","_slicedToArray","_useState3","_useState4","filteredData","setFilteredData","_useState5","_useState6","value","setValue","_useState7","_useState8","modal","setModal","_useState9","_useState10","fileName","setFileName","_useState11","_useState12","fileFormat","setFileFormat","toggleModal","renderTableData","map","col","_jsxs","children","_jsx","Fragment","ExtensionsHeader","title","subTitle","link","Row","className","Col","sm","Card","CardBody","Button","Ripple","color","onClick","Label","for","Input","bsSize","type","onChange","e","dataArr","target","length","filter","startsWithCondition","toLowerCase","startsWith","toString","includesCondition","includes","handleFilter","Table","innerRef","responsive","Modal","isOpen","toggle","onClosed","ModalHeader","ModalBody","FormGroup","placeholder","CustomInput","ModalFooter","bookType","wb","XLSX","utils","table_to_book","current","sheet","wbout","write","bookSST","file","concat","FileSaver","Blob","s","buf","ArrayBuffer","view","Uint8Array","i","charCodeAt","s2ab","handleExport","props","href","rel"],"mappings":"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","file":"static/js/336.96150c0a.chunk.js","sourcesContent":["import { Fragment, useState, useRef } from 'react'\nimport ExtensionsHeader from '@components/extensions-header'\nimport XLSX from 'xlsx'\nimport * as FileSaver from 'file-saver'\nimport {\n  Row,\n  Col,\n  Card,\n  CardBody,\n  Button,\n  Table,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  Input,\n  FormGroup,\n  CustomInput,\n  Label\n} from 'reactstrap'\n\nconst initialData = [\n  {\n    id: 1,\n    name: 'Leanne Graham',\n    username: 'Bret',\n    email: 'Sincere@april.biz',\n    website: 'hildegard.org'\n  },\n  {\n    id: 2,\n    name: 'Ervin Howell',\n    username: 'Antonette',\n    email: 'Shanna@melissa.tv',\n    website: 'anastasia.net'\n  },\n  {\n    id: 3,\n    name: 'Clementine Bauch',\n    username: 'Samantha',\n    email: 'Nathan@yesenia.net',\n    website: 'ramiro.info'\n  },\n  {\n    id: 4,\n    name: 'Patricia Lebsack',\n    username: 'Karianne',\n    email: 'Julianne.OConner@kory.org',\n    website: 'kale.biz'\n  },\n  {\n    id: 5,\n    name: 'Chelsey Dietrich',\n    username: 'Kamren',\n    email: 'Lucio_Hettinger@annie.ca',\n    website: 'demarco.info'\n  },\n  {\n    id: 6,\n    name: 'Mrs. Dennis Schulist',\n    username: 'Leopoldo_Corkery',\n    email: 'Karley_Dach@jasper.info',\n    website: 'ola.org'\n  },\n  {\n    id: 7,\n    name: 'Kurtis Weissnat',\n    username: 'Elwyn.Skiles',\n    email: 'Telly.Hoeger@billy.biz',\n    website: 'elvis.io'\n  },\n  {\n    id: 8,\n    name: 'Nicholas Runolfsdottir V',\n    username: 'Maxime_Nienow',\n    email: 'Sherwood@rosamond.me',\n    website: 'jacynthe.com'\n  },\n  {\n    id: 9,\n    name: 'Glenna Reichert',\n    username: 'Delphine',\n    email: 'Chaim_McDermott@dana.io',\n    website: 'conrad.com'\n  },\n  {\n    id: 10,\n    name: 'Clementina DuBuque',\n    username: 'Moriah.Stanton',\n    email: 'Rey.Padberg@karina.biz',\n    website: 'ambrose.net'\n  }\n]\n\nconst Export = () => {\n  const tableRef = useRef()\n\n  const [data] = useState(initialData)\n  const [filteredData, setFilteredData] = useState([])\n  const [value, setValue] = useState('')\n  const [modal, setModal] = useState(false)\n  const [fileName, setFileName] = useState('')\n  const [fileFormat, setFileFormat] = useState('xlsx')\n\n  const toggleModal = () => {\n    setModal(!modal)\n  }\n\n  const handleFilter = e => {\n    const dataArr = data\n    let filteredData = []\n    const value = e.target.value\n    setValue(value)\n    if (value.length) {\n      filteredData = dataArr.filter(col => {\n        const startsWithCondition =\n          col.name.toLowerCase().startsWith(value.toLowerCase()) ||\n          col.email.toLowerCase().startsWith(value.toLowerCase()) ||\n          col.website.toLowerCase().startsWith(value.toLowerCase()) ||\n          col.id.toString().toLowerCase().startsWith(value.toLowerCase())\n\n        const includesCondition =\n          col.name.toLowerCase().includes(value.toLowerCase()) ||\n          col.email.toLowerCase().includes(value.toLowerCase()) ||\n          col.website.toLowerCase().includes(value.toLowerCase()) ||\n          col.id.toString().toLowerCase().includes(value.toLowerCase())\n\n        if (startsWithCondition) return startsWithCondition\n        else if (!startsWithCondition && includesCondition) return includesCondition\n        else return null\n      })\n      setFilteredData(filteredData)\n      setValue(value)\n    }\n  }\n\n  const handleExport = () => {\n    toggleModal()\n    const bookType = fileFormat\n    const wb = XLSX.utils.table_to_book(tableRef.current, { sheet: 'Sheet JS' })\n    const wbout = XLSX.write(wb, { bookType, bookSST: true, type: 'binary' })\n\n    const s2ab = s => {\n      const buf = new ArrayBuffer(s.length)\n      const view = new Uint8Array(buf)\n      for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff\n      return buf\n    }\n    const file = fileName.length ? `${fileName}.${fileFormat}` : `excel-sheet.${fileFormat}`\n\n    return FileSaver.saveAs(new Blob([s2ab(wbout)], { type: 'application/octet-stream' }), file)\n  }\n\n  const array = value ? filteredData : data\n  const renderTableData = array.map(col => {\n    return (\n      <tr key={col.id}>\n        <td>{col.email}</td>\n        <td>{col.name}</td>\n        <td>{col.website}</td>\n        <td>{col.id}</td>\n      </tr>\n    )\n  })\n  return (\n    <Fragment>\n      <ExtensionsHeader\n        title='XLSX'\n        subTitle='Xlsx is a parser and writer for various spreadsheet formats'\n        link='https://github.com/AdeleD/react-paginate'\n      />\n      <Row className='export-component'>\n        <Col sm='12'>\n          <Card>\n            <CardBody className='pb-0'>\n              <div className='d-flex justify-content-between flex-wrap flex-sm-row flex-column'>\n                <Button.Ripple color='primary' onClick={() => toggleModal()}>\n                  Export\n                </Button.Ripple>\n                <div className='d-flex align-items-center justify-content-end mt-sm-0 mt-1'>\n                  <Label for='search-input' className='mr-1'>\n                    Search\n                  </Label>\n                  <Input id='search-input' bsSize='sm' type='text' value={value} onChange={e => handleFilter(e)} />\n                </div>\n              </div>\n            </CardBody>\n            <Table innerRef={tableRef} className='table-hover-animation mt-2' responsive>\n              <thead>\n                <tr>\n                  <th>Email</th>\n                  <th>Name</th>\n                  <th>Website</th>\n                  <th>Rank</th>\n                </tr>\n              </thead>\n              <tbody>{renderTableData}</tbody>\n            </Table>\n          </Card>\n        </Col>\n      </Row>\n      <Modal\n        isOpen={modal}\n        toggle={() => toggleModal()}\n        className='modal-dialog-centered'\n        onClosed={() => setFileName('')}\n      >\n        <ModalHeader toggle={() => toggleModal()}>Export To Excel</ModalHeader>\n        <ModalBody>\n          <FormGroup>\n            <Input\n              type='text'\n              value={fileName}\n              onChange={e => setFileName(e.target.value)}\n              placeholder='Enter File Name'\n            />\n          </FormGroup>\n          <FormGroup>\n            <CustomInput\n              type='select'\n              id='selectFileFormat'\n              name='customSelect'\n              value={fileFormat}\n              onChange={e => setFileFormat(e.target.value)}\n            >\n              <option>xlsx</option>\n              <option>csv</option>\n              <option>txt</option>\n            </CustomInput>\n          </FormGroup>\n        </ModalBody>\n        <ModalFooter>\n          <Button color='primary' onClick={() => handleExport()}>\n            Export\n          </Button>\n          <Button color='flat-danger' onClick={() => toggleModal()}>\n            Cancel\n          </Button>\n        </ModalFooter>\n      </Modal>\n    </Fragment>\n  )\n}\n\nexport default Export\n","// ** React Imports\nimport Proptypes from 'prop-types'\nimport { Row, Col } from 'reactstrap'\n\nconst ExtensionsHeader = props => {\n  return (\n    <Row className='mb-2'>\n      <Col sm='12' className='ml-50'>\n        <p className='font-medium-5 mt-1 extension-title' data-tour='extension-title'>\n          {props.title}\n        </p>\n        {props.link ? (\n          <a href={props.link} target='_blank' rel='noopener noreferrer'>\n            {props.subTitle}\n          </a>\n        ) : (\n          <p className='text-primary'>{props.subTitle}</p>\n        )}\n      </Col>\n    </Row>\n  )\n}\nexport default ExtensionsHeader\n\n// ** PropTypes\nExtensionsHeader.propTypes = {\n  title: Proptypes.string.isRequired,\n  subTitle: Proptypes.string.isRequired,\n  link: Proptypes.string\n}\n"],"sourceRoot":""}