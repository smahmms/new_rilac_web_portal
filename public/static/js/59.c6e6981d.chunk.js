(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[59],{2359:function(e,t,a){"use strict";a.r(t);var s=a(476),c=a(497),n=a(477),i=a(21),r=a(1),o=a(16),l=a(648),d=a(478),u=(a(662),a(487)),b=a(0),h=a(1553),j=a(1515),g=(a(949),a(660)),m=a(474),p=a(495),O=a(470),f=a(496),_=a(484),x=a(485),v=a(483),y=a(486),k=a(1488),C=a(489),S=a(1513),w=a(1485),N=a(502),I=a(482),P=a(480),B=a(534),M=a(472),R=a(6);t.default=function(){var e=JSON.parse(localStorage.getItem("userData")),t=Object(l.a)(),a=Object(o.a)(t,2),H=(a[0],a[1],Object(g.g)()),F=Object(b.useRef)(),L=Object(b.useRef)(),q=Object(b.useRef)(),D=Object(b.useState)([]),T=Object(o.a)(D,2),U=T[0],z=T[1],A=Object(b.useState)(!1),J=Object(o.a)(A,2),V=J[0],E=J[1],W=Object(b.useState)(null),G=Object(o.a)(W,2),K=G[0],Q=G[1],X=Object(b.useState)([]),Y=Object(o.a)(X,2),Z=Y[0],$=Y[1],ee=Object(b.useState)(null),te=Object(o.a)(ee,2),ae=te[0],se=te[1],ce=Object(b.useState)(!0),ne=Object(o.a)(ce,2),ie=ne[0],re=ne[1],oe=Object(b.useState)([]),le=Object(o.a)(oe,2),de=le[0],ue=le[1],be=Object(b.useState)([]),he=Object(o.a)(be,2),je=he[0],ge=he[1],me=Object(b.useState)({title:"",body:"",thumbnail_height:0,thumbnail_width:0,fb_adset_id:"",image_hash:"",link_url:"",image_url:"",image:"",effective_instagram_media_id:"",is_fb_page_post:!1,fb_page_post_category_ids:[],facebookpage_subcategory_localuids:[]}),pe=Object(o.a)(me,2),Oe=pe[0],fe=pe[1],_e=function(e){fe(Object(r.a)(Object(r.a)({},Oe),{},Object(i.a)({},e.target.name,e.target.value)))};Object(b.useEffect)((function(){var e=function(){var e=Object(n.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.adRuleList().then((function(e){console.log(e);var t,a=[],s=Object(c.a)(e.data.payload);try{for(s.s();!(t=s.n()).done;){var n=t.value;!0===n.is_approved&&a.push(n)}}catch(i){s.e(i)}finally{s.f()}$(a.map((function(e){return{value:e.id,label:e.rule_name}})))})).catch((function(e){Object(M.a)(e),console.log(e)}));case 2:return localStorage.setItem("usePMStoken",!1),localStorage.setItem("useBMStoken",!0),e.next=6,d.a.campaignList().then((function(e){console.log("campaignList",e),z(e.data),localStorage.setItem("useBMStoken",!1)})).catch((function(e){var t;401===(null===(t=e.response)||void 0===t?void 0:t.status)?(localStorage.setItem("BMSCall",!0),d.a.getBMStoken({username:B.f,password:B.d}).then((function(e){localStorage.setItem("BMStoken",e.data.jwtToken),localStorage.setItem("BMSCall",!1),re(!ie)})).catch((function(e){localStorage.setItem("BMSCall",!1),console.log(e)}))):(Object(M.a)(e),console.log(e),localStorage.setItem("useBMStoken",!1))}));case 6:localStorage.setItem("usePMStoken",!1),localStorage.setItem("useBMStoken",!1),d.a.getFbpageCategory().then((function(e){ue(e.data.payload.map((function(e){return{value:{id:e.uid,subcategory:e.subcategory},label:null===e||void 0===e?void 0:e.name}})))})).catch((function(e){console.log(e.response),Object(M.a)(e)}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[ie]);return Object(R.jsxs)(b.Fragment,{children:[Object(R.jsx)(O.a.Ripple,{className:"mb-1",color:"primary",tag:m.b,to:"vendor"===(null===e||void 0===e?void 0:e.role)?"/adlistVendor":"/adlist",children:Object(R.jsxs)("div",{className:"d-flex align-items-center",children:[Object(R.jsx)(h.a,{size:17,style:{marginRight:"5px"}}),Object(R.jsx)("span",{children:"Back"})]})}),Object(R.jsxs)(f.a,{style:{width:"100%"},onSubmit:function(t){t.preventDefault(),E(!0);var a=Oe.title,c=Oe.body,i=Oe.thumbnail_height,r=Oe.thumbnail_width,o=Oe.fb_adset_id,l=Oe.link_url,u=Oe.image_url,b=Oe.image,h=Oe.effective_instagram_media_id,j=Oe.image_hash,g=Oe.campaign_id,m=Oe.is_fb_page_post,p=Oe.fb_page_post_category_ids,O=Oe.facebookpage_subcategory_localuids;console.log({title:a,body:c,thumbnail_height:i,thumbnail_width:r,fb_adset_id:o,link_url:l,image_url:u,image:b,effective_instagram_media_id:h,image_hash:j,campaign_id:g,is_fb_page_post:m,fb_page_post_category_ids:p,facebookpage_subcategory_localuids:O});var f=new FormData;f.append("image",K),d.a.singleFileupload(f).then(function(){var t=Object(n.a)(Object(s.a)().mark((function t(n){return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),t.t0=d.a,t.t1=a,t.t2=c,t.t3=i,t.t4=r,t.t5=o,t.t6=l,t.t7=u,t.next=11,n.data.payload.image_url;case 11:return t.t8=t.sent,t.t9=h,t.t10=j,t.t11=g,t.t12=m,t.t13=p,t.t14=O,t.t15={title:t.t1,body:t.t2,thumbnail_height:t.t3,thumbnail_width:t.t4,fb_adset_id:t.t5,link_url:t.t6,image_url:t.t7,image:t.t8,effective_instagram_media_id:t.t9,image_hash:t.t10,campaign_id:t.t11,is_fb_page_post:t.t12,fb_page_post_category_ids:t.t13,facebookpage_subcategory_localuids:t.t14},t.next=21,t.t0.createAd.call(t.t0,t.t15).then((function(t){E(!1),Object(M.c)(t),console.log(t),H.push("vendor"===(null===e||void 0===e?void 0:e.role)?"/adlistVendor":"/adlist")})).catch((function(e){E(!1),Object(M.a)(e),console.log(e.response)}));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e.response),E(!1)}))},autoComplete:"off",children:[Object(R.jsx)("h4",{className:"m-1",children:"AD Info"}),Object(R.jsxs)(_.a,{className:"match-height",children:[Object(R.jsx)(x.a,{sm:"6",children:Object(R.jsx)(v.a,{children:Object(R.jsx)(y.a,{children:Object(R.jsxs)(_.a,{children:[Object(R.jsx)(x.a,{sm:"12",children:Object(R.jsxs)(k.a,{children:[Object(R.jsxs)(C.a,{for:"title",children:["Title",Object(R.jsx)("span",{className:"text-danger",children:"*"})]}),Object(R.jsx)(S.a,{type:"text",name:"title",id:"title",value:Oe.title,onChange:_e,required:!0,placeholder:"title here..."})]})}),Object(R.jsx)(x.a,{sm:"12",children:Object(R.jsxs)(k.a,{children:[Object(R.jsxs)(C.a,{for:"body",children:["Body",Object(R.jsx)("span",{className:"text-danger",children:"*"})]}),Object(R.jsx)(S.a,{type:"textarea",rows:"4",name:"body",id:"body",value:Oe.body,onChange:_e,required:!0,placeholder:"body"})]})})]})})})}),Object(R.jsxs)(x.a,{sm:"6",children:[Object(R.jsx)(v.a,{children:Object(R.jsx)(y.a,{children:Object(R.jsxs)(_.a,{children:[Object(R.jsxs)(x.a,{sm:"12",children:[Object(R.jsxs)(k.a,{children:[Object(R.jsxs)(C.a,{for:"type",children:["AD Rule",Object(R.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(R.jsx)(p.a,{ref:F,theme:u.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:function(e){fe(Object(r.a)(Object(r.a)({},Oe),{},{fb_adset_id:e.value}))},options:Z,menuPlacement:"auto"})]}),Object(R.jsx)(S.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:function(e){return F.current.select.focus()},value:Oe.fb_adset_id||"",onChange:function(e){return""}})]}),Object(R.jsxs)(x.a,{sm:"12",children:[Object(R.jsxs)(k.a,{children:[Object(R.jsxs)(C.a,{for:"type",children:["Select Campaign",Object(R.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(R.jsx)(p.a,{ref:q,theme:u.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:function(e){fe(Object(r.a)(Object(r.a)({},Oe),{},{campaign_id:e.value}))},options:U.map((function(e){return{value:e.id,label:e.campaignName}})),menuPlacement:"auto"})]}),Object(R.jsx)(S.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:function(e){return q.current.select.focus()},value:Oe.campaign_id||"",onChange:function(e){return""}})]})]})})}),"`"]})]}),Object(R.jsx)(v.a,{children:Object(R.jsx)(y.a,{children:Object(R.jsxs)(_.a,{children:[Object(R.jsx)(x.a,{sm:"4",children:Object(R.jsx)(k.a,{children:Object(R.jsx)(w.a,{type:"switch",onChange:function(e){e.target.checked?fe(Object(r.a)(Object(r.a)({},Oe),{},{is_fb_page_post:!0})):(fe(Object(r.a)(Object(r.a)({},Oe),{},{is_fb_page_post:!1})),ge([]))},id:"is_fb_page_post",label:"Is Facebook Page Post?",checked:Oe.is_fb_page_post})})}),Oe.is_fb_page_post&&Object(R.jsx)(x.a,{md:"4",sm:"6",children:Object(R.jsxs)(k.a,{children:[Object(R.jsxs)(C.a,{for:"fb_page_post_category_ids",children:["Facebook Page Category ",Object(R.jsx)("span",{style:{color:"red"},children:"*"})]}),de.length?Object(R.jsx)(p.a,{ref:L,theme:u.i,className:"basic-multi-select",classNamePrefix:"select",name:"businesscategories",options:de,onChange:function(e){return function(e){var t=[],a=[];console.log("selected ",e),e.length&&e[e.length-1].value.subcategory&&e.map((function(e){e.value.subcategory.map((function(e){t.push(e)})),a.push(e.value.id)})),0===e.length?(ge([]),fe(Object(r.a)(Object(r.a)({},Oe),{},{fb_page_post_category_ids:[]}))):(ge(t.length?t:je),fe(Object(r.a)(Object(r.a)({},Oe),{},{fb_page_post_category_ids:a})))}(e)},isMulti:!0,isClearable:!1}):Object(R.jsx)(N.a,{color:"primary"}),Object(R.jsx)(S.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:function(e){return L.current.select.focus()},value:Oe.fb_page_post_category_ids||"",onChange:function(e){return""}})]})}),0!==(null===je||void 0===je?void 0:je.length)&&Object(R.jsx)(x.a,{sm:"4",children:Object(R.jsxs)(k.a,{children:[Object(R.jsx)(C.a,{for:"facebookpage_subcategory_localuid",children:"Facebook Page Sub Category"}),Object(R.jsx)(p.a,{theme:u.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:function(e){return function(e){fe(Object(r.a)(Object(r.a)({},Oe),{},{facebookpage_subcategory_localuids:e.map((function(e){return e.value}))}))}(e)},isMulti:!0,isClearable:!1,options:null===je||void 0===je?void 0:je.map((function(e){return{value:e.uid,label:e.name}}))})]})})]})})}),Object(R.jsxs)(v.a,{children:[Object(R.jsx)(I.a,{className:"border-bottom",children:Object(R.jsx)(P.a,{tag:"h4",children:"Image info"})}),Object(R.jsx)(y.a,{style:{paddingTop:"15px"},children:Object(R.jsxs)(_.a,{children:[Object(R.jsx)(x.a,{sm:"6",children:Object(R.jsxs)(k.a,{children:[Object(R.jsx)(C.a,{for:"thumbnail_height",children:"Thumbnail Height"}),Object(R.jsx)(S.a,{type:"number",name:"thumbnail_height",id:"thumbnail_height",value:Oe.thumbnail_height,onChange:_e,placeholder:"thumbnail height here..."})]})}),Object(R.jsx)(x.a,{sm:"6",children:Object(R.jsxs)(k.a,{children:[Object(R.jsx)(C.a,{for:"thumbnail_width",children:"Thumbnail Width"}),Object(R.jsx)(S.a,{type:"number",name:"thumbnail_width",id:"thumbnail_width",value:Oe.thumbnail_width,onChange:_e,placeholder:"thumbnail width here..."})]})}),Object(R.jsx)(x.a,{sm:"6",children:Object(R.jsxs)(k.a,{children:[Object(R.jsx)(C.a,{for:"link_url",children:"Link URL"}),Object(R.jsx)(S.a,{type:"text",name:"link_url",id:"link_url",value:Oe.link_url,onChange:_e,placeholder:"link url"})]})}),Object(R.jsx)(x.a,{sm:"6",children:Object(R.jsxs)(k.a,{children:[Object(R.jsx)(C.a,{for:"image_url",children:"Image URL"}),Object(R.jsx)(S.a,{type:"text",name:"image_url",id:"image_url",value:Oe.image_url,onChange:_e,placeholder:"image url"})]})}),Object(R.jsxs)(x.a,{md:"12",className:"mb-2",children:[Object(R.jsx)(C.a,{for:"voucherImage",children:"Upload Image"}),Object(R.jsxs)("div",{className:"d-flex",children:[Object(R.jsxs)("div",{className:"file position-relative overflow-hidden mr-2",children:[Object(R.jsxs)("div",{className:"text-center p-1",style:{height:"102px",width:"102px",border:"1px dashed #d9d9d9",backgroundColor:"#fafafa"},children:[Object(R.jsx)("span",{children:Object(R.jsx)(j.a,{size:20,className:"my-1"})})," ",Object(R.jsx)("br",{}),Object(R.jsx)("span",{children:"Upload"})]}),Object(R.jsx)(S.a,{style:{position:"absolute",opacity:"0",left:"0",top:"0",height:"102px",width:"102px",cursor:"pointer"},type:"file",accept:"image/png, image/jpeg",required:!0,name:"voucherImage",id:"voucherImage",onChange:function(e){0!==e.target.files.length&&se(URL.createObjectURL(e.target.files[0])),Q(e.target.files[0]),function(e){E(!0);var t=new FormData;t.append("filename",e),d.a.getImageHash(t).then((function(e){var t;for(var a in e.data.payload.images)t=e.data.payload.images[a].hash;console.log("ImageHash",e),fe(Object(r.a)(Object(r.a)({},Oe),{},{image_hash:t})),E(!1)})).catch((function(e){Object(M.a)(e),console.log(e),E(!1)}))}(e.target.files[0])}})]}),ae&&Object(R.jsx)("img",{src:ae,alt:"voucher img",height:"100px"})]})]})]})})]}),Object(R.jsx)(v.a,{children:Object(R.jsx)(y.a,{children:Object(R.jsx)(_.a,{children:Object(R.jsx)(x.a,{sm:"12",className:"text-center",children:V?Object(R.jsxs)(O.a.Ripple,{color:"primary",className:"mr-1",disabled:!0,children:[Object(R.jsx)(N.a,{color:"white",size:"sm"}),Object(R.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(R.jsx)(O.a.Ripple,{className:"ml-2",color:"primary",type:"submit",children:Object(R.jsx)("span",{children:"Submit"})})})})})})]})]})}},472:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i}));a(0);var s=a(127),c=function(e){try{var t=e.response;404===t.status||401===t.status||400===t.status||500===t.status||409===t.status?s.f.error(t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):s.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},n=function(e){try{var t=e.response;404!==t.status&&401!==t.status&&400!==t.status||s.f.error(t.data.errors?t.data.errors[Object.keys(t.data.errors)[0]]:t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},i=function(e){var t=e.data.message||"success";s.f.success(t,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},662:function(e,t,a){}}]);
//# sourceMappingURL=59.c6e6981d.chunk.js.map